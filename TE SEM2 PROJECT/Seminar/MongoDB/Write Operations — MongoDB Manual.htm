<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
    <title>Write Operations — MongoDB Manual</title>

    <link rel="shortcut icon" href="http://media.mongodb.org/favicon.ico">
    <meta name="robots" content="index">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="canonical" href="http://docs.mongodb.org/manual/core/write-operations">

    
    
    <link rel="stylesheet" href="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/mongodb-docs.css" type="text/css">
    <link rel="stylesheet" href="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/pygments.css" type="text/css">
      
    <script id="undefined" src="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/inpage_linkid.js" async="" type="text/javascript"></script><script src="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/ga.js" async="" type="text/javascript"></script><script src="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/cse.js" async="" type="text/javascript"></script><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.2.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/jquery.js"></script>
    <script type="text/javascript" src="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/underscore.js"></script>
    <script type="text/javascript" src="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/doctools.js"></script>
      <link rel="search" type="application/opensearchdescription+xml" href="http://docs.mongodb.org/osd.xml" title="MongoDB Help">
<link rel="author" title="About these documents" href="http://docs.mongodb.org/manual/about/">
<link rel="top" title="MongoDB Manual" href="http://docs.mongodb.org/manual/">
<link rel="up" title="Core MongoDB Operations (CRUD)" href="http://docs.mongodb.org/manual/crud/">
<link rel="next" title="Data Modeling Considerations for MongoDB Applications" href="http://docs.mongodb.org/manual/core/data-modeling/">
<link rel="prev" title="Read Operations" href="http://docs.mongodb.org/manual/core/read-operations/">
<!-- Put the following javascript before the closing </head> tag. -->
<script>
  (function() {
    var cx = '017213726194841070573:WMX6838984';
    var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
  })();
</script>
  <script type="text/javascript" src="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/jsapi"></script><link rel="stylesheet" href="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/defaulten.css" type="text/css"><link rel="stylesheet" href="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/default.css" type="text/css"><script src="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/defaulten.js" type="text/javascript"></script><script src="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/search.js" type="text/javascript"></script><style type="text/css">.atlwdg-blanket {background:#000;height:100%;left:0;opacity:.5;position:fixed;top:0;width:100%;z-index:1000000;}
.atlwdg-popup {background:#fff;border:1px solid #666;position:fixed;top:50%;left:50%;z-index:10000011;}
.atlwdg-popup.atlwdg-box-shadow {-moz-box-shadow:10px 10px 20px rgba(0,0,0,0.5);-webkit-box-shadow:10px 10px 20px rgba(0,0,0,0.5);box-shadow:10px 10px 20px rgba(0,0,0,0.5);background-color:#fff;}
.atlwdg-hidden {display:none;}
.atlwdg-trigger {position: fixed; background: #013466; padding: 5px;border: 2px solid white;border-top: none; font-weight: bold; color: white; display:block;white-space:nowrap;text-decoration:none; font-family:arial, FreeSans, Helvetica, sans-serif;font-size:12px;box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);-webkit-box-shadow:5px 5px 10px rgba(0, 0, 0, 0.5); -moz-box-shadow:5px 5px 10px rgba(0, 0, 0, 0.5);border-radius: 0 0 5px 5px; -moz-border-radius: 0 0 5px 5px;}
a.atlwdg-trigger {text-decoration:none;}
.atlwdg-trigger.atlwdg-TOP {left: 45%;top:0; }
.atlwdg-trigger.atlwdg-RIGHT {left:100%; top:40%; -webkit-transform-origin:top left; -webkit-transform: rotate(90deg); -moz-transform: rotate(90deg); -moz-transform-origin:top left;-ms-transform: rotate(90deg); -ms-transform-origin:top left; }
.atlwdg-trigger.atlwdg-SUBTLE { right:0; bottom:0; border: 1px solid #ccc; border-bottom: none; border-right: none; background-color: #f5f5f5; color: #444; font-size: 11px; padding: 6px; box-shadow: -1px -1px 2px rgba(0, 0, 0, 0.5); border-radius: 2px 0 0 0; }
.atlwdg-loading {position:absolute;top:220px;left:295px;}</style></head>
  <body>
<div id="top-right">
        <div class="user-right">
                <ul id="header-menu-bar" class="ajs-menu-bar">
                <li class="normal"><a target="_blank" href="http://groups.google.com/group/mongodb-user">Forums</a></li>
                <li class="normal"><a target="_blank" href="http://blog.mongodb.org/">Blog</a></li>
                <li class="normal"><a href="http://www.mongodb.org/downloads">Download</a></li>
                <li class="normal"><a href="http://docs.mongodb.org/ecosystem/drivers/">Drivers</a></li>
                <li class="normal"><a href="http://www.10gen.com/events">Events</a></li>
                <li class="normal last"><a class="last" href="http://docs.mongodb.org/manual/meta/translation">Translations</a></li>
                </ul>
        </div>
</div>
<div id="header-db" class="spread">
        <div class="split">
                <div id="logo">
                        <div><a href="http://docs.mongodb.org/manual/"><img class="logo" src="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/logo-mongodb.png" alt="MongoDB Logo"></a></div>
                </div>
        </div>

<div class="search-db"><gcse:searchbox></gcse:searchbox></div>
<div id="etp">
<ul>
<li><a href="https://github.com/mongodb/docs/blob/master/source/core/write-operations.txt" target="_blank" title="Edit core/write-operations.txt on github">Edit this Page</a></li>
<li><a href="http://github.com/mongodb/docs" target="_blank" title="Fork the documentation on GitHub and contribute.">GitHub</a></li>
<li><a href="https://jira.mongodb.org/secure/CreateIssueDetails%21init.jspa?pid=10380&amp;issuetype=4&amp;priority=4&amp;summary=Comment+on%3a+%22core/write-operations%2Etxt%22" target="_blank" title="Report a problem with core/write-operations.txt on Jira">Report a problem</a></li>
</ul>
</div>
</div>  
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            <div id="cse-results"><gcse:searchresults></gcse:searchresults></div>
            
  <div class="section" id="write-operations">
<h1>Write Operations<a class="headerlink" href="#write-operations" title="Permalink to this headline">¶</a></h1>
<p>All operations that create or modify data in the MongoDB instance are
write operations. MongoDB represents data as <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-document"><em class="xref std std-term">BSON documents</em></a> stored in <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-collection"><em class="xref std std-term">collections</em></a>. Write
operations target one collection and are atomic on the level of a
single document: no single write operation can atomically affect more
than one document or more than one collection.</p>
<p>This document introduces the write operators available in MongoDB as
well as presents strategies to increase the efficiency of writes in
applications.</p>
<div class="section" id="write-operators">
<span id="write-operations-operators"></span><span id="index-0"></span><h2>Write Operators<a class="headerlink" href="#write-operators" title="Permalink to this headline">¶</a></h2>
<p>For information on write operators and how to write data to a MongoDB
database, see the following pages:</p>
<ul class="simple">
<li><a class="reference internal" href="http://docs.mongodb.org/manual/applications/create/"><em>Create</em></a></li>
<li><a class="reference internal" href="http://docs.mongodb.org/manual/applications/update/"><em>Update</em></a></li>
<li><a class="reference internal" href="http://docs.mongodb.org/manual/applications/delete/"><em>Delete</em></a></li>
</ul>
<p>For information on specific methods used to perform write operations in the
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongo/#mongo" title="mongo"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongo</span></tt></a> shell, see the following:</p>
<ul class="simple">
<li><a class="reference internal" href="http://docs.mongodb.org/manual/reference/method/db.collection.insert/#db.collection.insert" title="db.collection.insert"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.insert()</span></tt></a></li>
<li><a class="reference internal" href="http://docs.mongodb.org/manual/reference/method/db.collection.update/#db.collection.update" title="db.collection.update"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.update()</span></tt></a></li>
<li><a class="reference internal" href="http://docs.mongodb.org/manual/reference/method/db.collection.save/#db.collection.save" title="db.collection.save"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.save()</span></tt></a></li>
<li><a class="reference internal" href="http://docs.mongodb.org/manual/reference/method/db.collection.findAndModify/#db.collection.findAndModify" title="db.collection.findAndModify"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.findAndModify()</span></tt></a></li>
<li><a class="reference internal" href="http://docs.mongodb.org/manual/reference/method/db.collection.remove/#db.collection.remove" title="db.collection.remove"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.remove()</span></tt></a></li>
</ul>
<p>For information on how to perform write operations from within an
application, see the <a class="reference internal" href="http://docs.mongodb.org/manual/applications/drivers/"><em>MongoDB Drivers and Client Libraries</em></a> documentation or the
documentation for your client library.</p>
</div>
<div class="section" id="write-concern">
<span id="write-operations-write-concern"></span><span id="index-1"></span><span id="id1"></span><h2>Write Concern<a class="headerlink" href="#write-concern" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="http://docs.mongodb.org/manual/release-notes/drivers-write-concern/"><em>driver write concern</em></a>
change created a new connection class in all of the MongoDB
drivers, called <tt class="docutils literal"><span class="pre">MongoClient</span></tt> with a different default write
concern. See the <a class="reference internal" href="http://docs.mongodb.org/manual/release-notes/drivers-write-concern/"><em>release notes</em></a>
for this change, and the release notes for the driver you’re using
for more information about your driver’s release.</p>
</div>
<div class="section" id="operational-considerations-and-write-concern">
<span id="write-concern-considerations"></span><h3>Operational Considerations and Write Concern<a class="headerlink" href="#operational-considerations-and-write-concern" title="Permalink to this headline">¶</a></h3>
<p>Clients issue write operations with some level of <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-write-concern"><em class="xref std std-term">write
concern</em></a>, which describes the level of concern or
guarantee the server will provide in its response to a write operation.
Consider the following levels of conceptual write concern:</p>
<ul id="write-concern-errors-ignored">
<li><p class="first"><em>errors ignored</em>: Write operations are not acknowledged by MongoDB, and may
not succeed in the case of connection errors that the client is not yet aware of, or
if the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongod/#mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> produces an exception (e.g. a duplicate key
exception for <a class="reference internal" href="http://docs.mongodb.org/manual/core/indexes/#index-type-unique"><em>unique indexes</em></a>.) While this
operation is efficient because it does not require the database to
respond to every write operation, it also incurs a significant risk
with regards to the persistence and durability of the data.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Do not use this option in normal operation.</p>
</div>
</li>
</ul>
<ul id="write-concern-unacknowledged">
<li><p class="first"><em>unacknowledged</em>: MongoDB does not acknowledge the receipt of write
operation as with a write concern level of <em>ignore</em>; however, the
driver will receive and handle network errors, as possible given
system networking configuration.</p>
<p>Before the releases outlined in <a class="reference internal" href="http://docs.mongodb.org/manual/release-notes/drivers-write-concern/#driver-write-concern-change"><em>Default Write Concern Change</em></a>,
this was the default write concern.</p>
</li>
</ul>
<ul class="simple" id="write-concern-acknowledged">
<li>receipt <em>acknowledged</em>: The <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongod/#mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> will confirm the
receipt of the write operation, allowing the client to catch
network, duplicate key, and other exceptions. After the releases
outlined in <a class="reference internal" href="http://docs.mongodb.org/manual/release-notes/drivers-write-concern/#driver-write-concern-change"><em>Default Write Concern Change</em></a>, this is the default
write concern. <a class="footnote-reference" href="#default-write-concern" id="id2">[1]</a></li>
</ul>
<ul id="write-concern-replica-journaled">
<li><p class="first"><em>journaled</em>: The <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongod/#mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> will confirm the write
operation only after it has written the operation to the
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-journal"><em class="xref std std-term">journal</em></a>. This confirms that the write operation can survive a
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongod/#mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> shutdown and ensures that the write operation is
durable.</p>
<p>While receipt <em>acknowledged</em> without <em>journaled</em> provides the
fundamental basis for write concern, there is an up-to 100
millisecond window between journal commits where the write operation
is not fully durable. Require <em>journaled</em> as part of the write
concern to provide this durability guarantee.</p>
</li>
</ul>
<p id="write-concern-replica-acknowledged"><a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-replica-set"><em class="xref std std-term">Replica sets</em></a> present an additional layer of
consideration for write concern. Basic write concern levels affect the
write operation on only one <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongod/#mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> instance. The <tt class="docutils literal"><span class="pre">w</span></tt>
argument to <a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/getLastError/#getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> provides a <em>replica
acknowledged</em> level of write concern. With <em>replica acknowledged</em> you
can guarantee that the write operation has propagated to the members
of a replica set. See the <a class="reference internal" href="http://docs.mongodb.org/manual/applications/replication/#replica-set-write-concern"><em>Write Concern for Replica Sets</em></a> document for more information.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Requiring <em>journaled</em> write concern in a replica set only requires
a journal commit of the write operation to the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-primary"><em class="xref std std-term">primary</em></a> of the
set regardless of the level of <em>replica acknowledged</em> write
concern.</p>
</div>
<table class="docutils footnote" frame="void" id="default-write-concern" rules="none">
<colgroup><col class="label"><col></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td>The default write concern is to call
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/getLastError/#getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> with no arguments. For replica sets, you
can define the default write concern settings in the
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/replica-configuration/#local.system.replset.settings.getLastErrorDefaults" title="local.system.replset.settings.getLastErrorDefaults"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorDefaults</span></tt></a>
If <a class="reference internal" href="http://docs.mongodb.org/manual/reference/replica-configuration/#local.system.replset.settings.getLastErrorDefaults" title="local.system.replset.settings.getLastErrorDefaults"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorDefaults</span></tt></a> does
not define a default write concern setting,
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/getLastError/#getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> defaults to basic receipt acknowledgment.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="internal-operation-of-write-concern">
<span id="write-concern-internals"></span><span id="write-concern-operation"></span><h3>Internal Operation of Write Concern<a class="headerlink" href="#internal-operation-of-write-concern" title="Permalink to this headline">¶</a></h3>
<p>To provide write concern, <a class="reference internal" href="http://docs.mongodb.org/manual/applications/drivers/"><em>drivers</em></a> issue
the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/getLastError/#getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> command after a write operation and
receive a document with information about the last operation. This
document’s <tt class="docutils literal"><span class="pre">err</span></tt> field contains either:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">null</span></tt>, which indicates the write operations have completed
successfully, or</li>
<li>a description of the last error encountered.</li>
</ul>
<p>The definition of a “successful write” depends on the arguments
specified to <a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/getLastError/#getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a>, or in replica sets, the
configuration of
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/replica-configuration/#local.system.replset.settings.getLastErrorDefaults" title="local.system.replset.settings.getLastErrorDefaults"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorDefaults</span></tt></a>.
When deciding the level of write
concern for your application, become familiar with the
<a class="reference internal" href="#write-concern-considerations"><em>Operational Considerations and Write Concern</em></a>.</p>
<p>The <a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/getLastError/#getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> command has the following options to configure write
concern requirements:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">j</span></tt> or “journal” option</p>
<p>This option confirms that the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongod/#mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> instance has written
the data to the on-disk journal and ensures data is not lost if the
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongod/#mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> instance shuts down unexpectedly. Set to <tt class="docutils literal"><span class="pre">true</span></tt> to
enable, as shown in the following example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">runCommand</span><span class="p">(</span> <span class="p">{</span> <span class="nx">getLastError</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">j</span><span class="o">:</span> <span class="s2">"true"</span> <span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
<p>If you set <a class="reference internal" href="http://docs.mongodb.org/manual/reference/configuration-options/#journal" title="journal"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">journal</span></tt></a> to true, and the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongod/#mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> does
not have journaling enabled, as with <a class="reference internal" href="http://docs.mongodb.org/manual/reference/configuration-options/#nojournal" title="nojournal"><tt class="xref mongodb mongodb-setting docutils literal"><span class="pre">nojournal</span></tt></a>, then
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/getLastError/#getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> will provide basic receipt acknowledgment,
and will include a <tt class="docutils literal"><span class="pre">jnote</span></tt> field in its return document.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">w</span></tt> option</p>
<p>This option provides the ability to disable write concern entirely <em>as
well as</em> specifies the write concern operations for <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-replica-set"><em class="xref std std-term">replica sets</em></a>. See <a class="reference internal" href="#write-concern-considerations"><em>Operational Considerations and Write Concern</em></a> for an
introduction to the fundamental concepts of write concern. By
default, the <tt class="docutils literal"><span class="pre">w</span></tt> option is set to <tt class="docutils literal"><span class="pre">1</span></tt>, which provides basic
receipt acknowledgment on a single <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongod/#mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a>
instance or on the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-primary"><em class="xref std std-term">primary</em></a> in a replica set.</p>
<p>The <tt class="docutils literal"><span class="pre">w</span></tt> option takes the following values:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">-1</span></tt>:</p>
<p>Disables all acknowledgment of write operations, and suppresses
all including network and socket errors.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">0</span></tt>:</p>
<p>Disables basic acknowledgment of write operations, but returns
information about socket excepts and networking errors to the
application.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you disable basic write operation acknowledgment but require
journal commit acknowledgment, the journal commit prevails, and
the driver will require that <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongod/#mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a>  will
acknowledge the replica set.</p>
</div>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">1</span></tt>:</p>
<p>Provides acknowledgment of write operations on a standalone
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongod/#mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> or the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-primary"><em class="xref std std-term">primary</em></a> in a replica set.</p>
</li>
<li><p class="first"><em>A number greater than 1</em>:</p>
<p>Guarantees that write operations have propagated successfully to
the specified number of replica set members including the primary.
If you set <tt class="docutils literal"><span class="pre">w</span></tt> to a number that is greater than the number of set
members that hold data, MongoDB waits for the non-existent members
to become available, which means MongoDB blocks indefinitely.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">majority</span></tt>:</p>
<p>Confirms that write operations have propagated to the majority of
configured replica set: nodes must acknowledge the write operation
before it succeeds. This ensures that write operation will <em>never</em>
be subject to a rollback in the course of normal operation, and
furthermore allows you to prevent hard coding assumptions about the
size of your replica set into your application.</p>
</li>
<li><p class="first"><em>A tag set</em>:</p>
<p>By specifying a <a class="reference internal" href="http://docs.mongodb.org/manual/reference/replica-configuration/#replica-set-configuration-tag-sets"><em>tag set</em></a>
you can have fine-grained control over which replica
set members must acknowledge a write operation to satisfy the required
level of write concern.</p>
</li>
</ul>
</li>
</ul>
<p><a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/getLastError/#getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> also supports a <tt class="docutils literal"><span class="pre">wtimeout</span></tt> setting which
allows clients to specify a timeout for the write concern: if you
don’t specify <tt class="docutils literal"><span class="pre">wtimeout</span></tt> and the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongod/#mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> cannot fulfill
the write concern the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/getLastError/#getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> will block,
potentially forever.</p>
<p>For more information on write concern and replica sets, see <a class="reference internal" href="http://docs.mongodb.org/manual/applications/replication/#replica-set-write-concern"><em>Write
Concern for Replica Sets</em></a> for more information..</p>
<p>In sharded clusters, <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongos/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> instances will pass write
concern on to the shard <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongod/#mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> instances.</p>
</div>
</div>
<div class="section" id="bulk-inserts">
<span id="write-operations-bulk-insert"></span><h2>Bulk Inserts<a class="headerlink" href="#bulk-inserts" title="Permalink to this headline">¶</a></h2>
<p>In some situations you may need to insert or ingest a large amount of
data into a MongoDB database. These <em>bulk inserts</em> have some
special considerations that are different from other write
operations.</p>
<p>The <a class="reference internal" href="http://docs.mongodb.org/manual/reference/method/db.collection.insert/#db.collection.insert" title="db.collection.insert"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">insert()</span></tt></a> method, when passed an
array of documents, will perform a bulk insert, and inserts each
document atomically. <a class="reference internal" href="http://docs.mongodb.org/manual/applications/drivers/"><em>Drivers</em></a>
provide their own interface for this kind of operation.</p>
<p class="versionadded">
<span class="versionmodified">New in version 2.2: </span><a class="reference internal" href="http://docs.mongodb.org/manual/reference/method/db.collection.insert/#db.collection.insert" title="db.collection.insert"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">insert()</span></tt></a> in the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongo/#mongo" title="mongo"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongo</span></tt></a>
shell gained support for bulk inserts in version 2.2.</p>
<p>Bulk insert can significantly increase performance by amortizing
<a class="reference internal" href="#write-operations-write-concern"><em>write concern</em></a> costs. In the
drivers, you can configure write concern for batches rather than on a
per-document level.</p>
<p>Drivers also have a <tt class="docutils literal"><span class="pre">ContinueOnError</span></tt> option in their insert
operation, so that the bulk operation will continue to insert
remaining documents in a batch even if an insert fails.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last versionadded">
<span class="versionmodified">New in version 2.0: </span>Support for <tt class="docutils literal"><span class="pre">ContinueOnError</span></tt> depends on version 2.0 of the
core <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongod/#mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> and <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongos/#mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> components.</p>
</div>
<p>If the bulk insert process generates more than one error in a batch
job, the client will only receive the most recent error. All bulk
operations to a <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-sharded-cluster"><em class="xref std std-term">sharded collection</em></a> run with
<tt class="docutils literal"><span class="pre">ContinueOnError</span></tt>, which applications cannot disable. See
<a class="reference internal" href="http://docs.mongodb.org/manual/tutorial/manage-chunks-in-sharded-cluster/#sharding-bulk-inserts"><em>Strategies for Bulk Inserts in Sharded Clusters</em></a> section for more information on
consideration for bulk inserts in sharded clusters.</p>
<p>For more information see your <a class="reference internal" href="http://docs.mongodb.org/manual/applications/drivers/"><em>driver documentation</em></a> for details on performing bulk inserts in
your application. Also consider the following resources:
<a class="reference internal" href="#write-operations-sharded-clusters"><em>Sharded Clusters</em></a>,
<a class="reference internal" href="http://docs.mongodb.org/manual/tutorial/manage-chunks-in-sharded-cluster/#sharding-bulk-inserts"><em>Strategies for Bulk Inserts in Sharded Clusters</em></a>, and
<a class="reference internal" href="http://docs.mongodb.org/manual/administration/import-export/"><em>Importing and Exporting MongoDB Data</em></a>.</p>
</div>
<div class="section" id="indexing">
<span id="write-operations-indexing"></span><h2>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline">¶</a></h2>
<p>After every insert, update, or delete operation, MongoDB must update
<em>every</em> index associated with the collection in addition to the data
itself. Therefore, every index on a collection adds some amount of
overhead for the performance of write operations. <a class="footnote-reference" href="#exceptions" id="id3">[2]</a></p>
<p>In general, the performance gains that indexes provide for <em>read
operations</em> are worth the insertion penalty; however, when optimizing
write performance, be careful when creating new indexes and always
evaluate the indexes on the collection and ensure that your queries are
actually using these indexes.</p>
<p>For more information on indexes in MongoDB consider <a class="reference internal" href="http://docs.mongodb.org/manual/indexes/"><em>Indexes</em></a>
and <a class="reference internal" href="http://docs.mongodb.org/manual/applications/indexes/"><em>Indexing Strategies</em></a>.</p>
<table class="docutils footnote" frame="void" id="exceptions" rules="none">
<colgroup><col class="label"><col></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>The overhead for <a class="reference internal" href="http://docs.mongodb.org/manual/core/indexes/#index-type-sparse"><em>sparse indexes</em></a> inserts and updates to un-indexed fields
is less than for non-sparse indexes. Also for non-sparse indexes,
updates that don’t change the record size have less indexing
overhead.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="isolation">
<span id="write-operations-isolation"></span><h2>Isolation<a class="headerlink" href="#isolation" title="Permalink to this headline">¶</a></h2>
<p>When a single write operation modifies multiple documents, the
operation as a whole is not atomic, and other operations may
interleave. The modification of a single document, or record, is always
atomic, even if the write operation modifies multiple sub-document
<em>within</em> the single record.</p>
<p>No other operations are atomic; however, you can attempt to isolate a
write operation that affects multiple documents using the
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/operator/isolated/"><em>isolation operator</em></a>.</p>
<p>To isolate a sequence of write operations from other read and write
operations, see <a class="reference internal" href="http://docs.mongodb.org/manual/tutorial/perform-two-phase-commits/"><em>Perform Two Phase Commits</em></a>.</p>
</div>
<div class="section" id="updates">
<h2>Updates<a class="headerlink" href="#updates" title="Permalink to this headline">¶</a></h2>
<p>Each document in a MongoDB collection has allocated <em>record</em> space
which includes the entire document <em>and</em> a small amount of
padding. This padding makes it possible for update operations to
increase the size of a document slightly without causing the document
to outgrow the allocated record size.</p>
<p>Documents in MongoDB can grow up to the full maximum <a class="reference internal" href="http://docs.mongodb.org/manual/reference/limits/#BSON%20Document%20Size" title="BSON Document Size"><tt class="xref mongodb mongodb-limit docutils literal"><span class="pre">BSON</span>
<span class="pre">document</span> <span class="pre">size</span></tt></a>. However, when documents outgrow
their allocated record size MongoDB must allocate a new record and
move the document to the new record. Update operations that do not
cause a document to grow, (i.e. <em>in-place</em> updates,) are significantly
more efficient than those updates that cause document growth. Use
<a class="reference internal" href="http://docs.mongodb.org/manual/core/data-modeling/"><em>data models</em></a> that minimize the need for
document growth when possible.</p>
<p>For complete examples of update operations, see
<a class="reference internal" href="http://docs.mongodb.org/manual/applications/update/"><em>Update</em></a>.</p>
</div>
<div class="section" id="padding-factor">
<span id="write-operations-padding-factor"></span><h2>Padding Factor<a class="headerlink" href="#padding-factor" title="Permalink to this headline">¶</a></h2>
<p>If an update operation does not cause the document to increase in
size, MongoDB can apply the update in-place. Some updates
change the size of the document, for example using the
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/operator/push/#_S_push" title="$push"><tt class="xref mongodb mongodb-operator docutils literal"><span class="pre">$push</span></tt></a> operator to append a sub-document to an array can
cause the top level document to grow beyond its allocated space.</p>
<p>When documents grow, MongoDB relocates the document on disk with
enough contiguous space to hold the document. These relocations
take longer than in-place updates, particularly if the collection has
indexes that MongoDB must update all index entries. If
collection has many indexes, the move will impact write throughput.</p>
<p>To minimize document movements, MongoDB employs padding. MongoDB
adaptively learns if documents in a collection tend to grow, and if
they do, adds a <a class="reference internal" href="http://docs.mongodb.org/manual/reference/collection-statistics/#collStats.paddingFactor" title="collStats.paddingFactor"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">paddingFactor</span></tt></a> so that the documents have room
to grow on subsequent writes. The <a class="reference internal" href="http://docs.mongodb.org/manual/reference/collection-statistics/#collStats.paddingFactor" title="collStats.paddingFactor"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">paddingFactor</span></tt></a> indicates the
padding for new inserts and moves.</p>
<p class="versionadded">
<span class="versionmodified">New in version 2.2: </span>You can use the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/collMod/#collMod" title="collMod"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">collMod</span></tt></a> command
with the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/collMod/#usePowerOf2Sizes" title="usePowerOf2Sizes"><tt class="xref mongodb mongodb-collflag docutils literal"><span class="pre">usePowerOf2Sizes</span></tt></a> flag so that MongoDB
allocates document space in sizes that are powers of 2. This helps
ensure that MongoDB can efficiently reuse the space freed as a
result of deletions or document relocations. As with all padding,
using document space allocations with power of 2 sizes minimizes,
but does not eliminate, document movements.</p>
<p>To check the current <a class="reference internal" href="http://docs.mongodb.org/manual/reference/collection-statistics/#collStats.paddingFactor" title="collStats.paddingFactor"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">paddingFactor</span></tt></a> on a collection, you can
run the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/method/db.collection.stats/#db.collection.stats" title="db.collection.stats"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.stats()</span></tt></a> operation in the
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongo/#mongo" title="mongo"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongo</span></tt></a> shell, as in the following example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">myCollection</span><span class="p">.</span><span class="nx">stats</span><span class="p">()</span>
</pre></div>
</div>
<p>Since MongoDB writes each document at a different point in time, the
padding for each document will not be the same. You can calculate the
padding size by subtracting 1 from the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/collection-statistics/#collStats.paddingFactor" title="collStats.paddingFactor"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">paddingFactor</span></tt></a>, for
example:</p>
<div class="highlight-none"><div class="highlight"><pre>padding size = (paddingFactor - 1) * &lt;document size&gt;.
</pre></div>
</div>
<p>For example, a <a class="reference internal" href="http://docs.mongodb.org/manual/reference/collection-statistics/#collStats.paddingFactor" title="collStats.paddingFactor"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">paddingFactor</span></tt></a> of <tt class="docutils literal"><span class="pre">1.0</span></tt> specifies no padding
whereas a paddingFactor of <tt class="docutils literal"><span class="pre">1.5</span></tt> specifies a padding size of <tt class="docutils literal"><span class="pre">0.5</span></tt> or 50
percent (50%) of the document size.</p>
<p>Because the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/collection-statistics/#collStats.paddingFactor" title="collStats.paddingFactor"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">paddingFactor</span></tt></a> is relative to the size of each
document, you cannot calculate the exact amount of padding for a
collection based on the average document size and padding factor.</p>
<p>If an update operation causes the document to <em>decrease</em> in size, for
instance if you perform an <a class="reference internal" href="http://docs.mongodb.org/manual/reference/operator/unset/#_S_unset" title="$unset"><tt class="xref mongodb mongodb-operator docutils literal"><span class="pre">$unset</span></tt></a> or a <a class="reference internal" href="http://docs.mongodb.org/manual/reference/operator/pop/#_S_pop" title="$pop"><tt class="xref mongodb mongodb-operator docutils literal"><span class="pre">$pop</span></tt></a>
update, the document remains in place and effectively has more
padding. If the document remains this size, the space is not reclaimed
until you perform a <a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/compact/#compact" title="compact"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">compact</span></tt></a> or a
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/repairDatabase/#repairDatabase" title="repairDatabase"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">repairDatabase</span></tt></a> operation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The following operations remove padding:</p>
<ul class="simple">
<li><a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/compact/#compact" title="compact"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">compact</span></tt></a>,</li>
<li><a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/repairDatabase/#repairDatabase" title="repairDatabase"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">repairDatabase</span></tt></a>, and</li>
<li>initial replica sync operations.</li>
</ul>
<p>However, with the <a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/compact/#compact" title="compact"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">compact</span></tt></a> command, you can run the
command with a <tt class="docutils literal"><span class="pre">paddingFactor</span></tt> or a <tt class="docutils literal"><span class="pre">paddingBytes</span></tt> parameter.</p>
<p>Padding is also removed if you use <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongoexport/#mongoexport" title="mongoexport"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongoexport</span></tt></a> from a
collection. If you use <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongoimport/#mongoimport" title="mongoimport"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongoimport</span></tt></a> into a new
collection, <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongoimport/#mongoimport" title="mongoimport"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongoimport</span></tt></a> will not add padding.  If you
use <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongoimport/#mongoimport" title="mongoimport"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongoimport</span></tt></a> with an existing collection with
padding, <a class="reference internal" href="http://docs.mongodb.org/manual/reference/mongoimport/#mongoimport" title="mongoimport"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongoimport</span></tt></a> will not affect the existing
padding.</p>
<p class="last">When a database operation removes padding, subsequent update that
require changes in record sizes will have reduced throughput until
the collection’s padding factor grows. Padding does not affect
in-place, and after <a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/compact/#compact" title="compact"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">compact</span></tt></a>,
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/repairDatabase/#repairDatabase" title="repairDatabase"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">repairDatabase</span></tt></a>, and replica set initial sync
the collection will require less storage.</p>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="http://docs.mongodb.org/manual/faq/developers/#faq-developers-manual-padding"><em>Can I manually pad documents to prevent moves during updates?</em></a></li>
<li><a class="reference external" href="http://blog.mongodb.org/post/248614779/fast-updates-with-mongodb-update-in-place">Fast Updates with MongoDB with in-place Updates</a> (blog post)</li>
</ul>
</div>
</div>
<div class="section" id="architecture">
<h2>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h2>
<div class="section" id="replica-sets">
<span id="write-operations-replica-sets"></span><h3>Replica Sets<a class="headerlink" href="#replica-sets" title="Permalink to this headline">¶</a></h3>
<p>In <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-replica-set"><em class="xref std std-term">replica sets</em></a>, all write operations go to the
set’s <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-primary"><em class="xref std std-term">primary</em></a>, which applies the write operation then records
the operations on the primary’s operation log or <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-oplog"><em class="xref std std-term">oplog</em></a>. The
oplog is a reproducible sequence of operations to the data
set. <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-secondary"><em class="xref std std-term">Secondary</em></a> members of the set are continuously replicating the
oplog and applying the operations to themselves in an asynchronous
process.</p>
<p>Large volumes of write operations, particularly bulk operations, may
create situations where the secondary members have difficulty applying
the replicating operations from the primary at a sufficient rate: this
can cause the secondary’s state to fall behind that of the primary. Secondaries
that are significantly behind the primary present problems for normal
operation of the replica set, particularly <a class="reference internal" href="http://docs.mongodb.org/manual/administration/replica-sets/#replica-set-failover-administration"><em>failover</em></a> in the form of <a class="reference internal" href="http://docs.mongodb.org/manual/core/replication/#replica-set-rollback"><em>rollbacks</em></a> as well as general <a class="reference internal" href="http://docs.mongodb.org/manual/core/replication/#replica-set-consistency"><em>read consistency</em></a>.</p>
<p>To help avoid this issue, you can customize the <a class="reference internal" href="#write-operations-write-concern"><em>write concern</em></a> to return confirmation of the write
operation to another member <a class="footnote-reference" href="#write-concern-throttling" id="id4">[3]</a> of the replica
set every 100 or 1,000 operations. This provides an opportunity for
secondaries to catch up with the primary. Write concern can slow the
overall progress of write operations but ensure that the secondaries
can maintain a largely current state with respect to the primary.</p>
<p>For more information on replica sets and write operations, see
<a class="reference internal" href="http://docs.mongodb.org/manual/applications/replication/#replica-set-write-concern"><em>Write Concern</em></a>, <a class="reference internal" href="http://docs.mongodb.org/manual/core/replication/#replica-set-oplog-sizing"><em>Oplog</em></a>,
<a class="reference internal" href="http://docs.mongodb.org/manual/core/replication-internals/#replica-set-oplog"><em>Oplog Internals</em></a>, and <a class="reference internal" href="http://docs.mongodb.org/manual/administration/replica-sets/#replica-set-procedure-change-oplog-size"><em>Changing Oplog Size</em></a>.</p>
<table class="docutils footnote" frame="void" id="write-concern-throttling" rules="none">
<colgroup><col class="label"><col></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[3]</a></td><td>Calling <a class="reference internal" href="http://docs.mongodb.org/manual/reference/command/getLastError/#getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a>
intermittently with a <tt class="docutils literal"><span class="pre">w</span></tt> value of <tt class="docutils literal"><span class="pre">2</span></tt> or <tt class="docutils literal"><span class="pre">majority</span></tt> will
slow the throughput of write traffic; however, this practice will
allow the secondaries to remain current with the state of the
primary.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="sharded-clusters">
<span id="write-operations-sharded-clusters"></span><h3>Sharded Clusters<a class="headerlink" href="#sharded-clusters" title="Permalink to this headline">¶</a></h3>
<p>In a <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-sharded-cluster"><em class="xref std std-term">sharded cluster</em></a>, MongoDB directs a given write operation to
a <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-shard"><em class="xref std std-term">shard</em></a> and then performs the write on a particular
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-chunk"><em class="xref std std-term">chunk</em></a> on that shard. Shards and chunks are range-based.
<a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-shard-key"><em class="xref std std-term">Shard keys</em></a> affect how MongoDB distributes documents
among shards. Choosing the correct shard key can have a great impact on
the performance, capability, and functioning of your database and
cluster.</p>
<p>For more information, see <a class="reference internal" href="http://docs.mongodb.org/manual/administration/sharded-clusters/"><em>Sharded Cluster Administration</em></a> and
<a class="reference internal" href="#write-operations-bulk-insert"><em>Bulk Inserts</em></a>.</p>
</div>
</div>
</div>


<div id="btnv">
<ul id="btnvl">
<li id="btnvpr"><a href="http://docs.mongodb.org/manual/core/read-operations/" title="Previous Section: Read Operations">&lt; &nbsp; Read Operations</a></li>
<li id="btnvup"><a href="http://docs.mongodb.org/manual/crud/" title="Parent Section: Core MongoDB Operations (CRUD)">/\&nbsp; Core MongoDB Operations (CRUD)</a></li>
<li id="btnvnx"><a href="http://docs.mongodb.org/manual/core/data-modeling/" title="Next Section: Data Modeling Considerations for MongoDB Applications">Data Modeling Considerations for MongoDB Applications &nbsp;&gt;</a></li>
</ul>
</div>
</div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><h3><a href="http://docs.mongodb.org/manual/contents/">MongoDB Manual</a>

<small><a href="http://docs.mongodb.org/manual/genindex/">(Index)</a></small>

</h3>

<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="http://docs.mongodb.org/manual/installation/">Installing MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://docs.mongodb.org/manual/administration/">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://docs.mongodb.org/manual/security/">Security</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="http://docs.mongodb.org/manual/crud/">Core MongoDB Operations (CRUD)</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="http://docs.mongodb.org/manual/crud/#read-and-write-operations-in-mongodb">Read and Write Operations in MongoDB</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="http://docs.mongodb.org/manual/core/read-operations/">Read Operations</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">Write Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#write-operators">Write Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="#write-concern">Write Concern</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#operational-considerations-and-write-concern">Operational Considerations and Write Concern</a></li>
<li class="toctree-l5"><a class="reference internal" href="#internal-operation-of-write-concern">Internal Operation of Write Concern</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#bulk-inserts">Bulk Inserts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#indexing">Indexing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#isolation">Isolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#updates">Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#padding-factor">Padding Factor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#architecture">Architecture</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#replica-sets">Replica Sets</a></li>
<li class="toctree-l5"><a class="reference internal" href="#sharded-clusters">Sharded Clusters</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="http://docs.mongodb.org/manual/crud/#document-orientation-concepts">Document Orientation Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="http://docs.mongodb.org/manual/crud/#crud-operations-for-mongodb">CRUD Operations for MongoDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="http://docs.mongodb.org/manual/crud/#data-modeling-patterns">Data Modeling Patterns</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="http://docs.mongodb.org/manual/aggregation/">Aggregation</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://docs.mongodb.org/manual/indexes/">Indexes</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://docs.mongodb.org/manual/replication/">Replication</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://docs.mongodb.org/manual/sharding/">Sharding</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://docs.mongodb.org/manual/applications/">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://docs.mongodb.org/manual/mongo/">Using the <tt class="docutils literal"><span class="pre">mongo</span></tt> Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://docs.mongodb.org/manual/use-cases/">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://docs.mongodb.org/manual/tutorial/">MongoDB Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://docs.mongodb.org/manual/faq/">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://docs.mongodb.org/manual/reference/">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://docs.mongodb.org/manual/about/">About MongoDB Documentation</a></li>
</ul>

<h3 style="padding-bottom: 1em;"><a href="http://www.mongodb.org/about/">MongoDB.org</a></h3>
<h3 style="padding-bottom: 1em;"><a href="http://docs.mongodb.org/ecosystem/">MongoDB Ecosystem</a></h3><h3>Formats</h3>
<ul class="this-page-menu">
  <li><a href="http://docs.mongodb.org/master/single/">MongoDB Manual, Single HTML Page</a></li>
  <li><a href="http://docs.mongodb.org/master/MongoDB-Manual-master.pdf" rel="nofollow">MongoDB Manual, PDF Format</a></li>
  <li><a href="http://docs.mongodb.org/master/MongoDB-Manual-master.epub" rel="nofollow">MongoDB Manual, ePub Format</a></li>
</ul><h3>MongoDB Resources</h3>

<ul>
 <li><strong>Getting Started</strong>
   <ul>
     <li><a href="http://www.mongodb.org/about/introduction">Introduction</a></li>
     <li><a href="http://www.mongodb.org/downloads">Downloads</a></li>
   </ul>
 </li>
 <li><strong><a href="http://www.mongodb.org/about/community">Community</a> and <a href="http://docs.mongodb.org/ecosystem/">Ecosystem</a></strong>
   <ul>
     <li><a href="http://www.10gen.com/">10gen</a></li>
     <li><a href="http://www.10gen.com/events">MongoDB Events</a></li>
     <li><a href="http://planet.mongodb.org/">Planet MongoDB</a></li>
     <li><a href="http://mongodb.org/about/community/masters">MongoDB Masters</a></li>
     <li><a href="http://www.10gen.com/presentations">Slides and Video</a></li>
     <li><a href="http://docs.mongodb.org/ecosystem/platforms/">Hosting Center</a></li>
     <li><a href="http://docs.mongodb.org/ecosystem/platforms/windows">Windows</a></li>
     <li><a href="http://www.10gen.com/products/mms/">MongoDB Monitoring Service</a> (<a href="http://mms.10gen.com/help/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/tools/administration-interfaces/">Administrative Interfaces</a></li>
     <li><a href="http://www.10gen.com/books/">MongoDB Books</a></li>
   </ul>
 </li>
 <li><strong><a href="http://docs.mongodb.org/ecosystem/drivers/">Drivers</a></strong>
   <ul>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/javascript">JavaScript</a> (<a href="http://api.mongodb.org/js/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/python">Python</a> (<a href="http://api.mongodb.org/python/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/ruby">Ruby</a> (<a href="http://api.mongodb.org/ruby/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/php">PHP</a> (<a href="http://php.net/mongo/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/perl">Perl</a> (<a href="http://api.mongodb.org/perl/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/java">Java</a> (<a href="http://api.mongodb.org/java/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/scala">Scala</a> (<a href="http://api.mongodb.org/scala/casbah/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/csharp">C#</a> (<a href="http://api.mongodb.org/csharp/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/c">C</a> (<a href="http://api.mongodb.org/c/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/cpp">C++</a> (<a href="http://api.mongodb.org/cplusplus/current/">docs</a>)</li>
     <li><a href="http://hackage.haskell.org/package/mongoDB">Haskell</a> (<a href="http://api.mongodb.org/haskell">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/erlang">Erlang</a> (<a href="http://api.mongodb.org/erlang">docs</a>)</li>
   </ul>
 </li>
</ul>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    <p>
       © <a href="">Copyright</a> 2011-2013, 10gen, Inc. 
       MongoDB®, Mongo®, and the leaf logo are registered trademarks of 10gen, Inc.
    </p>
  </div><script type="text/javascript">
var _gaq = _gaq || [];
var pluginUrl = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.') + 'google-analytics.com/plugins/ga/inpage_linkid.js';
_gaq.push(['_require', 'inpage_linkid', pluginUrl]);
_gaq.push(['_setAccount', 'UA-7301842-8']);
_gaq.push(['_setDomainName', 'docs.mongodb.org']);
_gaq.push(['_trackPageview']);
(function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
        })();
</script>

<script type="text/javascript">
document.write(unescape("%3Cscript src='" + document.location.protocol + "//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="Write%20Operations%20%E2%80%94%20MongoDB%20Manual_files/munchkin.htm" type="text/javascript"></script>
<script>try { mktoMunchkin("017-HGS-593"); } catch(e) {}</script><script type="text/javascript">
jQuery.ajax({
    url: "https://jira.mongodb.org/s/en_US-bxctp1/782/6/1.2.4/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?collectorId=298ba4e7",
    type: "get",
    cache: true,
    dataType: "script"
});
window.ATL_JQ_PAGE_PROPS =  {
"triggerFunction": function(showCollectorDialog) {
jQuery("#jirafeedback").click(function(e) {e.preventDefault();showCollectorDialog();});
jQuery("#jirafooter").click(function(e) {e.preventDefault();showCollectorDialog();});
}};
</script>

<div style="display: none;" id="atlwdg-blanket" class="atlwdg-blanket"></div><div class="atlwdg-popup atlwdg-box-shadow atlwdg-hidden" id="atlwdg-container"></div></body></html>