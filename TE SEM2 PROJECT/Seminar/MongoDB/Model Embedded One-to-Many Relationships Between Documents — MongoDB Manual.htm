<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
    <title>Model Embedded One-to-Many Relationships Between Documents — MongoDB Manual</title>

    <link rel="shortcut icon" href="http://media.mongodb.org/favicon.ico">
    <meta name="robots" content="index">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="canonical" href="http://docs.mongodb.org/manual/tutorial/model-embedded-one-to-many-relationships-between-documents">

    
    
    <link rel="stylesheet" href="Model%20Embedded%20One-to-Many%20Relationships%20Between%20Documents%20%E2%80%94%20MongoDB%20Manual_files/mongodb-docs.css" type="text/css">
    <link rel="stylesheet" href="Model%20Embedded%20One-to-Many%20Relationships%20Between%20Documents%20%E2%80%94%20MongoDB%20Manual_files/pygments.css" type="text/css">
      
    <script src="Model%20Embedded%20One-to-Many%20Relationships%20Between%20Documents%20%E2%80%94%20MongoDB%20Manual_files/cse.js" async="" type="text/javascript"></script><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.2.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="Model%20Embedded%20One-to-Many%20Relationships%20Between%20Documents%20%E2%80%94%20MongoDB%20Manual_files/jquery.js"></script>
    <script type="text/javascript" src="Model%20Embedded%20One-to-Many%20Relationships%20Between%20Documents%20%E2%80%94%20MongoDB%20Manual_files/underscore.js"></script>
    <script type="text/javascript" src="Model%20Embedded%20One-to-Many%20Relationships%20Between%20Documents%20%E2%80%94%20MongoDB%20Manual_files/doctools.js"></script>
      <link rel="search" type="application/opensearchdescription+xml" href="http://docs.mongodb.org/osd.xml" title="MongoDB Help">
<link rel="author" title="About these documents" href="http://docs.mongodb.org/manual/about/">
<link rel="top" title="MongoDB Manual" href="http://docs.mongodb.org/manual/">
<link rel="up" title="Core MongoDB Operations (CRUD)" href="http://docs.mongodb.org/manual/crud/">
<link rel="next" title="Model Referenced One-to-Many Relationships Between Documents" href="http://docs.mongodb.org/manual/tutorial/model-referenced-one-to-many-relationships-between-documents/">
<link rel="prev" title="Model Embedded One-to-One Relationships Between Documents" href="http://docs.mongodb.org/manual/tutorial/model-embedded-one-to-one-relationships-between-documents/">
<!-- Put the following javascript before the closing </head> tag. -->
<script>
  (function() {
    var cx = '017213726194841070573:WMX6838984';
    var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
  })();
</script>
  <script type="text/javascript" src="Model%20Embedded%20One-to-Many%20Relationships%20Between%20Documents%20%E2%80%94%20MongoDB%20Manual_files/jsapi"></script><link rel="stylesheet" href="Model%20Embedded%20One-to-Many%20Relationships%20Between%20Documents%20%E2%80%94%20MongoDB%20Manual_files/defaulten.css" type="text/css"><link rel="stylesheet" href="Model%20Embedded%20One-to-Many%20Relationships%20Between%20Documents%20%E2%80%94%20MongoDB%20Manual_files/default.css" type="text/css"><script src="Model%20Embedded%20One-to-Many%20Relationships%20Between%20Documents%20%E2%80%94%20MongoDB%20Manual_files/defaulten.js" type="text/javascript"></script><script src="Model%20Embedded%20One-to-Many%20Relationships%20Between%20Documents%20%E2%80%94%20MongoDB%20Manual_files/search.js" type="text/javascript"></script><style type="text/css">
.gsc-control-cse {
font-family: Arial, sans-serif;
border-color: #FFFFFF;
background-color: #FFFFFF;
}
.gsc-control-cse .gsc-table-result {
font-family: Arial, sans-serif;
}
input.gsc-input, .gsc-input-box, .gsc-input-box-hover, .gsc-input-box-focus {
border-color: #D9D9D9;
}
input.gsc-search-button, input.gsc-search-button:hover, input.gsc-search-button:focus {
border-color: #5AAC41;
background-color: #5AAC41;
background-image: none;
filter: none;
}
.gsc-tabHeader.gsc-tabhInactive {
border-color: #CCCCCC;
background-color: #FFFFFF;
}
.gsc-tabHeader.gsc-tabhActive {
border-color: #CCCCCC;
border-bottom-color: #FFFFFF;
background-color: #FFFFFF;
}
.gsc-tabsArea {
border-color: #CCCCCC;
}
.gsc-webResult.gsc-result,
.gsc-results .gsc-imageResult {
border-color: #FFFFFF;
background-color: #FFFFFF;
}
.gsc-webResult.gsc-result:hover,
.gsc-imageResult:hover {
border-color: #FFFFFF;
background-color: #FFFFFF;
}
.gs-webResult.gs-result a.gs-title:link,
.gs-webResult.gs-result a.gs-title:link b,
.gs-imageResult a.gs-title:link,
.gs-imageResult a.gs-title:link b {
color: #1155CC;
}
.gs-webResult.gs-result a.gs-title:visited,
.gs-webResult.gs-result a.gs-title:visited b,
.gs-imageResult a.gs-title:visited,
.gs-imageResult a.gs-title:visited b {
color: #1155CC;
}
.gs-webResult.gs-result a.gs-title:hover,
.gs-webResult.gs-result a.gs-title:hover b,
.gs-imageResult a.gs-title:hover,
.gs-imageResult a.gs-title:hover b {
color: #1155CC;
}
.gs-webResult.gs-result a.gs-title:active,
.gs-webResult.gs-result a.gs-title:active b,
.gs-imageResult a.gs-title:active,
.gs-imageResult a.gs-title:active b {
color: #1155CC;
}
.gsc-cursor-page {
color: #1155CC;
}
a.gsc-trailing-more-results:link {
color: #1155CC;
}
.gs-webResult .gs-snippet,
.gs-imageResult .gs-snippet,
.gs-fileFormatType {
color: #333333;
}
.gs-webResult div.gs-visibleUrl,
.gs-imageResult div.gs-visibleUrl {
color: #009933;
}
.gs-webResult div.gs-visibleUrl-short {
color: #009933;
}
.gs-webResult div.gs-visibleUrl-short {
display: none;
}
.gs-webResult div.gs-visibleUrl-long {
display: block;
}
.gs-promotion div.gs-visibleUrl-short {
display: none;
}
.gs-promotion div.gs-visibleUrl-long {
display: block;
}
.gsc-cursor-box {
border-color: #FFFFFF;
}
.gsc-results .gsc-cursor-box .gsc-cursor-page {
border-color: #CCCCCC;
background-color: #FFFFFF;
color: #1155CC;
}
.gsc-results .gsc-cursor-box .gsc-cursor-current-page {
border-color: #CCCCCC;
background-color: #FFFFFF;
color: #1155CC;
}
.gsc-webResult.gsc-result.gsc-promotion {
border-color: #F6F6F6;
background-color: #F6F6F6;
}
.gsc-completion-title {
color: #1155CC;
}
.gsc-completion-snippet {
color: #333333;
}
.gs-promotion a.gs-title:link,
.gs-promotion a.gs-title:link *,
.gs-promotion .gs-snippet a:link {
color: #1155CC;
}
.gs-promotion a.gs-title:visited,
.gs-promotion a.gs-title:visited *,
.gs-promotion .gs-snippet a:visited {
color: #1155CC;
}
.gs-promotion a.gs-title:hover,
.gs-promotion a.gs-title:hover *,
.gs-promotion .gs-snippet a:hover {
color: #1155CC;
}
.gs-promotion a.gs-title:active,
.gs-promotion a.gs-title:active *,
.gs-promotion .gs-snippet a:active {
color: #1155CC;
}
.gs-promotion .gs-snippet,
.gs-promotion .gs-title .gs-promotion-title-right,
.gs-promotion .gs-title .gs-promotion-title-right * {
color: #333333;
}
.gs-promotion .gs-visibleUrl,
.gs-promotion .gs-visibleUrl-short {
color: #009933;
}
.gsc-input input.gsc-input {
background: none repeat scroll 0% 0% white !important;
}
</style></head>
  <body>
<div id="top-right">
        <div class="user-right">
                <ul id="header-menu-bar" class="ajs-menu-bar">
                <li class="normal"><a target="_blank" href="http://groups.google.com/group/mongodb-user">Forums</a></li>
                <li class="normal"><a target="_blank" href="http://blog.mongodb.org/">Blog</a></li>
                <li class="normal"><a href="http://www.mongodb.org/downloads">Download</a></li>
                <li class="normal"><a href="http://docs.mongodb.org/ecosystem/drivers/">Drivers</a></li>
                <li class="normal"><a href="http://www.10gen.com/events">Events</a></li>
                <li class="normal last"><a class="last" href="http://docs.mongodb.org/manual/meta/translation">Translations</a></li>
                </ul>
        </div>
</div>
<div id="header-db" class="spread">
        <div class="split">
                <div id="logo">
                        <div><a href="http://docs.mongodb.org/manual/"><img class="logo" src="Model%20Embedded%20One-to-Many%20Relationships%20Between%20Documents%20%E2%80%94%20MongoDB%20Manual_files/logo-mongodb.png" alt="MongoDB Logo"></a></div>
                </div>
        </div>

<div class="search-db"><gcse:searchbox></gcse:searchbox></div>
<div id="etp">
<ul>
<li><a href="https://github.com/mongodb/docs/blob/master/source/tutorial/model-embedded-one-to-many-relationships-between-documents.txt" target="_blank" title="Edit tutorial/model-embedded-one-to-many-relationships-between-documents.txt on github">Edit this Page</a></li>
<li><a href="http://github.com/mongodb/docs" target="_blank" title="Fork the documentation on GitHub and contribute.">GitHub</a></li>
<li><a href="https://jira.mongodb.org/secure/CreateIssueDetails%21init.jspa?pid=10380&amp;issuetype=4&amp;priority=4&amp;summary=Comment+on%3a+%22tutorial/model-embedded-one-to-many-relationships-between-documents%2Etxt%22" target="_blank" title="Report a problem with tutorial/model-embedded-one-to-many-relationships-between-documents.txt on Jira">Report a problem</a></li>
</ul>
</div>
</div>  
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            <div id="cse-results"><gcse:searchresults></gcse:searchresults></div>
            
  <div class="section" id="model-embedded-one-to-many-relationships-between-documents">
<span id="data-modeling-example-one-to-many"></span><h1>Model Embedded One-to-Many Relationships Between Documents<a class="headerlink" href="#model-embedded-one-to-many-relationships-between-documents" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Data in MongoDB has a <em>flexible schema</em>. <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-collection"><em class="xref std std-term">Collections</em></a> do not enforce <a class="reference internal" href="http://docs.mongodb.org/manual/reference/glossary/#term-document"><em class="xref std std-term">document</em></a> structure. Decisions
that affect how you model data can affect application performance and
database capacity. See <a class="reference internal" href="http://docs.mongodb.org/manual/core/data-modeling/"><em>Data Modeling Considerations for MongoDB Applications</em></a> for a full high
level overview of data modeling in MongoDB.</p>
<p>This document describes a data model that uses <a class="reference internal" href="http://docs.mongodb.org/manual/core/data-modeling/#data-modeling-embedding"><em>embedded</em></a> documents to describe relationships between
connected data.</p>
</div>
<div class="section" id="pattern">
<h2>Pattern<a class="headerlink" href="#pattern" title="Permalink to this headline">¶</a></h2>
<p>Consider the following example that maps patron and multiple address
relationships. The example illustrates the advantage of embedding over
referencing if you need to view many data entities in context of
another. In this one-to-many relationship between <tt class="docutils literal"><span class="pre">patron</span></tt> and
<tt class="docutils literal"><span class="pre">address</span></tt> data, the <tt class="docutils literal"><span class="pre">patron</span></tt> has multiple <tt class="docutils literal"><span class="pre">address</span></tt> entities.</p>
<p>In the normalized data model, the <tt class="docutils literal"><span class="pre">address</span></tt> contains a reference to
the <tt class="docutils literal"><span class="pre">parent</span></tt>.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="nx">_id</span><span class="o">:</span> <span class="s2">"joe"</span><span class="p">,</span>
   <span class="nx">name</span><span class="o">:</span> <span class="s2">"Joe Bookreader"</span>
<span class="p">}</span>

<span class="p">{</span>
   <span class="nx">patron_id</span><span class="o">:</span> <span class="s2">"joe"</span><span class="p">,</span>
   <span class="nx">street</span><span class="o">:</span> <span class="s2">"123 Fake Street"</span><span class="p">,</span>
   <span class="nx">city</span><span class="o">:</span> <span class="s2">"Faketon"</span><span class="p">,</span>
   <span class="nx">state</span><span class="o">:</span> <span class="s2">"MA"</span><span class="p">,</span>
   <span class="nx">zip</span><span class="o">:</span> <span class="mi">12345</span>
<span class="p">}</span>

<span class="p">{</span>
   <span class="nx">patron_id</span><span class="o">:</span> <span class="s2">"joe"</span><span class="p">,</span>
   <span class="nx">street</span><span class="o">:</span> <span class="s2">"1 Some Other Street"</span><span class="p">,</span>
   <span class="nx">city</span><span class="o">:</span> <span class="s2">"Boston"</span><span class="p">,</span>
   <span class="nx">state</span><span class="o">:</span> <span class="s2">"MA"</span><span class="p">,</span>
   <span class="nx">zip</span><span class="o">:</span> <span class="mi">12345</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If your application frequently retrieves the <tt class="docutils literal"><span class="pre">address</span></tt> data with the
<tt class="docutils literal"><span class="pre">name</span></tt> information, then your application needs to issue multiple
queries to resolve the references. A more optimal schema would be to
embed the <tt class="docutils literal"><span class="pre">address</span></tt> data entities in the <tt class="docutils literal"><span class="pre">patron</span></tt> data, as in the
following document:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="nx">_id</span><span class="o">:</span> <span class="s2">"joe"</span><span class="p">,</span>
   <span class="nx">name</span><span class="o">:</span> <span class="s2">"Joe Bookreader"</span><span class="p">,</span>
   <span class="nx">addresses</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="nx">street</span><span class="o">:</span> <span class="s2">"123 Fake Street"</span><span class="p">,</span>
                  <span class="nx">city</span><span class="o">:</span> <span class="s2">"Faketon"</span><span class="p">,</span>
                  <span class="nx">state</span><span class="o">:</span> <span class="s2">"MA"</span><span class="p">,</span>
                  <span class="nx">zip</span><span class="o">:</span> <span class="mi">12345</span>
                <span class="p">},</span>
                <span class="p">{</span>
                  <span class="nx">street</span><span class="o">:</span> <span class="s2">"1 Some Other Street"</span><span class="p">,</span>
                  <span class="nx">city</span><span class="o">:</span> <span class="s2">"Boston"</span><span class="p">,</span>
                  <span class="nx">state</span><span class="o">:</span> <span class="s2">"MA"</span><span class="p">,</span>
                  <span class="nx">zip</span><span class="o">:</span> <span class="mi">12345</span></pre></div></div></div></div></div></div></div></div></body></html>